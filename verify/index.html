<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RANNTA Verify</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#0f1115;color:#eaeaea;display:flex;min-height:100vh;align-items:center;justify-content:center}
    .card{background:#161a22;padding:24px 28px;border-radius:16px;max-width:640px;width:100%;box-shadow:0 6px 24px rgba(0,0,0,.35)}
    .ok{color:#57d9a3;font-weight:700}
    .bad{color:#ff6b6b;font-weight:700}
    .muted{opacity:.7}
    code{background:#0b0e13;padding:2px 6px;border-radius:6px}
  </style>
</head>
<body>
  <div class="card">
    <h1>RANNTA Verification</h1>
    <p class="muted">Check status for a given verification id.</p>
    <hr />
    <p><strong>ID:</strong> <code id="id">—</code></p>
    <p><strong>Status:</strong> <span id="status">Loading…</span></p>
    <p id="note" class="muted"></p>
  </div>

  <script>
    (async function () {
      const params = new URLSearchParams(window.location.search);
      const id = params.get("id");
      const idEl = document.getElementById("id");
      const stEl = document.getElementById("status");
      const noteEl = document.getElementById("note");

      idEl.textContent = id || "No ID provided";

      if (!id) {
        stEl.textContent = "Missing id";
        stEl.className = "bad";
        noteEl.textContent = "Add ?id=YOUR_ID to the URL.";
        return;
      }

      try {
        const res = await fetch("./ids.json", { cache: "no-store" });
        if (!res.ok) throw new Error("ids.json not found");
        const data = await res.json();
        const ok = Array.isArray(data.allowed) && data.allowed.includes(id);

        stEl.textContent = ok ? "VALID" : "NOT FOUND";
        stEl.className = ok ? "ok" : "bad";
        noteEl.textContent = ok
          ? "This verification ID is registered in the public registry."
          : "This verification ID was not found in the public registry.";
      } catch (e) {
        stEl.textContent = "Registry unavailable";
        stEl.className = "bad";
        noteEl.textContent = "Could not load ids.json";
      }
    })();
  </script>
</body>
</html>
